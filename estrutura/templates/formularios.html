{% extends "base.html" %}
{% block title %}Formul√°rios{% endblock %}

{% block content %}
<h2 style="text-align:center;">Formul√°rios</h2>
<p style="text-align:center; margin-bottom:1rem;">
  Clique em um card para preencher o formul√°rio <strong>dentro do sistema</strong>. Caso um formul√°rio n√£o permita
  incorpora√ß√£o, ele abrir√° em uma nova aba.
</p>

{# grade de cards no mesmo estilo dos Mapas #}
<div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:1rem;">
  {% for f in formularios %}
    {% if f.embed_url %}
      <a href="{% url 'formularios' %}?form={{ f.embed_url|urlencode }}" style="text-decoration:none;">
        <div
          style="
            background:#0d3b59; color:#fff; padding:1rem; border-radius:10px;
            box-shadow:0 4px 10px rgba(0,0,0,.08); min-height:110px;
            {% if form_selecionado == f.embed_url %}outline:3px solid #fff; outline-offset:-3px;{% endif %}
          ">
          <div style="font-weight:700; margin-bottom:.35rem;">üìù {{ f.nome }}</div>
          <div style="font-size:.95rem; opacity:.9;">Preencher embutido</div>
        </div>
      </a>
    {% else %}
      <a href="{{ f.open_url }}" target="_blank" rel="noopener noreferrer" style="text-decoration:none;">
        <div
          style="
            background:#0d3b59; color:#fff; padding:1rem; border-radius:10px;
            box-shadow:0 4px 10px rgba(0,0,0,.08); min-height:110px;
          ">
          <div style="font-weight:700; margin-bottom:.35rem;">üìù {{ f.nome }}</div>
          <div style="font-size:.95rem; opacity:.9;">Abrir em nova aba</div>
        </div>
      </a>
    {% endif %}
  {% endfor %}
</div>

{% if form_selecionado %}
  <div style="margin-top:2rem;">
    <div style="display:flex; align-items:center; gap:.75rem; margin-bottom:.5rem;">
      <h3 style="margin:0;">{{ form_nome }}</h3>
      {% if form_open_url %}
        <a href="{{ form_open_url }}" target="_blank" rel="noopener noreferrer" style="font-size:.95rem;">
          Abrir em nova aba ‚Üó
        </a>
      {% endif %}
    </div>

    <iframe
      src="{{ form_selecionado }}"
      title="Formul√°rio - {{ form_nome }}"
      width="100%" height="900"
      frameborder="0" allowfullscreen
      loading="lazy"
      referrerpolicy="strict-origin-when-cross-origin"
      style="border:none; background:#fff;">
    </iframe>
  </div>
{% endif %}
{% endblock %}
